"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
var common_1 = require("../common");
var Util = (function () {
    function Util() {
    }
    Util.getParserForAttr = function (i) {
        return Util.attributeParsers[i];
    };
    Util.parseUnicodeAttr = function (buf) {
        return common_1.default.stripNulls(common_1.default.decodeString(buf, 'utf16le'));
    };
    Util.parseByteArrayAttr = function (buf) {
        var newBuf = new Buffer(buf.length);
        buf.copy(newBuf);
        return newBuf;
    };
    Util.parseBoolAttr = function (buf) {
        return Util.parseWordAttr(buf) === 1;
    };
    Util.parseDWordAttr = function (buf, offset) {
        if (offset === void 0) { offset = 0; }
        return buf.readUInt32LE(offset);
    };
    Util.parseQWordAttr = function (buf, offset) {
        if (offset === void 0) { offset = 0; }
        return Util.readUInt64LE(buf, offset);
    };
    Util.parseWordAttr = function (buf, offset) {
        if (offset === void 0) { offset = 0; }
        return buf.readUInt16LE(offset);
    };
    Util.readUInt64LE = function (buffer, offset) {
        var high = buffer.slice(offset, offset + 4).readUInt32LE(0);
        var low = buffer.slice(offset + 4, offset + 8).readUInt32LE(0);
        var maxuint32 = Math.pow(2, 32);
        return ((low * maxuint32) + (high >>> 0));
    };
    Util.attributeParsers = [
        Util.parseUnicodeAttr,
        Util.parseByteArrayAttr,
        Util.parseBoolAttr,
        Util.parseDWordAttr,
        Util.parseQWordAttr,
        Util.parseWordAttr,
        Util.parseByteArrayAttr
    ];
    return Util;
}());
exports.Util = Util;
//# sourceMappingURL=Util.js.map